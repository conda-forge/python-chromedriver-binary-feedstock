{% set version = "131.0.6741.0.0" %}
{% set chromedriver_version = version[:-2] %}

package:
  name: python-chromedriver-binary
  version: {{ version }}

source:
  - url: https://github.com/danielkaiser/python-chromedriver-binary/archive/v{{ version }}.tar.gz
    sha256: bcac87d6617d596f4be821fb339bcc4a2e4c2cb5548ffa58510fc7933b737a15
  {% if noarch_platform == "linux" %}
  - url: https://edgedl.me.gvt1.com/edgedl/chrome/chrome-for-testing/{{ chromedriver_version }}/linux64/chromedriver-linux64.zip
    sha256: b32f5b527fc06125380b76d8d873d10909576fdc6434a69588246d14e80c9d38
  {% elif noarch_platform == "osx" %}
  - url: https://edgedl.me.gvt1.com/edgedl/chrome/chrome-for-testing/{{ chromedriver_version }}/mac-x64/chromedriver-mac-x64.zip
    sha256: 3d79485e38751c48f58d0c93240038a6e38baea2b897670c392b52cc17129db1
  {% elif noarch_platform == "win" %}
  - url: https://edgedl.me.gvt1.com/edgedl/chrome/chrome-for-testing/{{ chromedriver_version }}/win32/chromedriver-win32.zip
    sha256: b1eae644f68f75c6a99776d87f18a8cd2fb81f23bd6b806540476a56a7a16a25
  {% endif %}

build:
  number: 0
  noarch: python
  script:
    {% if noarch_platform in ["osx", "linux"] %}
    - chmod +x chromedriver
    {% endif %}
    - {{ PYTHON }} -m pip install . --no-deps --no-build-isolation -vv
  entry_points:
    - chromedriver-path = chromedriver_binary.utils:print_chromedriver_path
  {% if noarch_platform == "osx" %}
  binary_relocation: false
  {% endif %}

requirements:
  host:
    - pip
    - python >=3.7
    - setuptools
  run:
    - __{{ noarch_platform }}
    - python >=3.7

test:
  requires:
    - pip
  imports:
    - chromedriver_binary
  commands:
    - pip check
    - chromedriver-path
    # TODO: investigate on linux, (at least) libxcb is missing...
    {% if noarch_platform == "osx" %}
    - $(chromedriver-path)/chromedriver --version
    {% endif %}

about:
  home: https://github.com/danielkaiser/python-chromedriver-binary
  license: MIT
  license_family: MIT
  license_file: LICENSE
  summary: Downloads and installs the chromedriver binary version
  description: |
    Downloads and installs the chromedriver binary for automated
    testing of webapps. The installer supports Linux, MacOS and Windows
    operating systems.

extra:
  recipe-maintainers:
    - williamjamir
    - bollwyvl
