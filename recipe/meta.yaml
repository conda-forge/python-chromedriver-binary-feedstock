{% set version = "131.0.6725.0.0" %}
{% set chromedriver_version = version[:-2] %}

package:
  name: python-chromedriver-binary
  version: {{ version }}

source:
  - url: https://github.com/danielkaiser/python-chromedriver-binary/archive/v{{ version }}.tar.gz
    sha256: c6109af1e7e94fe26815abb413a53757b82c48b99bc34e8c92fd72e99ba998a9
  {% if noarch_platform == "linux" %}
  - url: https://edgedl.me.gvt1.com/edgedl/chrome/chrome-for-testing/{{ chromedriver_version }}/linux64/chromedriver-linux64.zip
    sha256: 4ee3fbf9fedef6e7961fb36572a7b2051347bf43a1a438bc2af75342c2cf2e49
  {% elif noarch_platform == "osx" %}
  - url: https://edgedl.me.gvt1.com/edgedl/chrome/chrome-for-testing/{{ chromedriver_version }}/mac-x64/chromedriver-mac-x64.zip
    sha256: 818aba1ebc4b82de4a2e003c6f452663ec086b07802d68b1af5252f982b67844
  {% elif noarch_platform == "win" %}
  - url: https://edgedl.me.gvt1.com/edgedl/chrome/chrome-for-testing/{{ chromedriver_version }}/win32/chromedriver-win32.zip
    sha256: 4e900ccc5f8a288aa12940f76d2d0e8eb768f80c4fbc766f7865ec25c11ee4a8
  {% endif %}

build:
  number: 0
  noarch: python
  script:
    {% if noarch_platform in ["osx", "linux"] %}
    - chmod +x chromedriver
    {% endif %}
    - {{ PYTHON }} -m pip install . --no-deps --no-build-isolation -vv
  entry_points:
    - chromedriver-path = chromedriver_binary.utils:print_chromedriver_path
  {% if noarch_platform == "osx" %}
  binary_relocation: false
  {% endif %}

requirements:
  host:
    - pip
    - python >=3.7
    - setuptools
  run:
    - __{{ noarch_platform }}
    - python >=3.7

test:
  requires:
    - pip
  imports:
    - chromedriver_binary
  commands:
    - pip check
    - chromedriver-path
    # TODO: investigate on linux, (at least) libxcb is missing...
    {% if noarch_platform == "osx" %}
    - $(chromedriver-path)/chromedriver --version
    {% endif %}

about:
  home: https://github.com/danielkaiser/python-chromedriver-binary
  license: MIT
  license_family: MIT
  license_file: LICENSE
  summary: Downloads and installs the chromedriver binary version
  description: |
    Downloads and installs the chromedriver binary for automated
    testing of webapps. The installer supports Linux, MacOS and Windows
    operating systems.

extra:
  recipe-maintainers:
    - williamjamir
    - bollwyvl
