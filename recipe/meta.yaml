{% set version = "132.0.6817.0.0" %}
{% set chromedriver_version = version[:-2] %}

package:
  name: python-chromedriver-binary
  version: {{ version }}

source:
  - url: https://github.com/danielkaiser/python-chromedriver-binary/archive/v{{ version }}.tar.gz
    sha256: 6f610a6e952bd985465efaa2364a87ad511c10298eae6af25614e36776f32751
  {% if noarch_platform == "linux" %}
  - url: https://edgedl.me.gvt1.com/edgedl/chrome/chrome-for-testing/{{ chromedriver_version }}/linux64/chromedriver-linux64.zip
    sha256: a02867df2a652d582fc185b2de02aa0f979d45b574b298c026df82f166353723
  {% elif noarch_platform == "osx" %}
  - url: https://edgedl.me.gvt1.com/edgedl/chrome/chrome-for-testing/{{ chromedriver_version }}/mac-x64/chromedriver-mac-x64.zip
    sha256: 85c76b58c49478d38dc65dcfd4e403c7b06d5d3021203fbf3555f61e8f257fe3
  {% elif noarch_platform == "win" %}
  - url: https://edgedl.me.gvt1.com/edgedl/chrome/chrome-for-testing/{{ chromedriver_version }}/win32/chromedriver-win32.zip
    sha256: 0556b12bf242e4dc57cc0178410405a6e90ee26ce3f7be7628d5937476a1db6c
  {% endif %}

build:
  number: 0
  noarch: python
  script:
    {% if noarch_platform in ["osx", "linux"] %}
    - chmod +x chromedriver
    {% endif %}
    - {{ PYTHON }} -m pip install . --no-deps --no-build-isolation -vv
  entry_points:
    - chromedriver-path = chromedriver_binary.utils:print_chromedriver_path
  {% if noarch_platform == "osx" %}
  binary_relocation: false
  {% endif %}

requirements:
  host:
    - pip
    - python >=3.7
    - setuptools
  run:
    - __{{ noarch_platform }}
    - python >=3.7

test:
  requires:
    - pip
  imports:
    - chromedriver_binary
  commands:
    - pip check
    - chromedriver-path
    # TODO: investigate on linux, (at least) libxcb is missing...
    {% if noarch_platform == "osx" %}
    - $(chromedriver-path)/chromedriver --version
    {% endif %}

about:
  home: https://github.com/danielkaiser/python-chromedriver-binary
  license: MIT
  license_family: MIT
  license_file: LICENSE
  summary: Downloads and installs the chromedriver binary version
  description: |
    Downloads and installs the chromedriver binary for automated
    testing of webapps. The installer supports Linux, MacOS and Windows
    operating systems.

extra:
  recipe-maintainers:
    - williamjamir
    - bollwyvl
